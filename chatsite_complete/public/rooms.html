<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Select Room ‚Äì ChatSystem</title>

<style>

    body {
        margin: 0;
        font-family: "Poppins", sans-serif;
        background: linear-gradient(135deg, #0f0f16, #1b1b33);
        height: 100vh;
        display: flex;
        overflow: hidden;
        color: white;
    }

    /* Background Lights */
    .bg1, .bg2 {
        position: fixed;
        width: 400px;
        height: 400px;
        filter: blur(150px);
        opacity: 0.22;
        z-index: 0;
    }
    .bg1 { background: #4dc9ff; top: -50px; left: -50px; }
    .bg2 { background: #a855f7; bottom: -60px; right: -60px; }

    /* SIDEBAR */
    .sidebar {
        width: 250px;
        background: rgba(255,255,255,0.06);
        backdrop-filter: blur(15px);
        padding: 20px;
        z-index: 10;
        height: 100vh;
        border-right: 1px solid rgba(255,255,255,0.08);
    }

    .sidebar h3 {
        font-size: 22px;
        margin-bottom: 15px;
        text-align: center;
    }

    .room-item {
        padding: 12px 15px;
        background: rgba(255,255,255,0.08);
        margin-bottom: 10px;
        border-radius: 10px;
        cursor: pointer;
        transition: 0.25s;
        font-size: 17px;
    }

    .room-item:hover, .room-item.active {
        background: rgba(255,255,255,0.16);
        transform: translateX(4px);
    }

    /* MAIN PANEL */
    .main-panel {
        flex: 1;
        z-index: 10;
        padding: 30px;
        position: relative;
    }

    .top-buttons {
        position: absolute;
        top: 15px;
        right: 20px;
        display: flex;
        gap: 12px;
        align-items: center;
    }

    .top-btn {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        cursor: pointer;
        background: rgba(255,255,255,0.16);
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 13px;
        transition: 0.3s;
    }

    .top-btn:hover {
        background: rgba(255,255,255,0.28);
    }

    /* ‚≠ê PROFILE ICON */
    .profile-btn {
        width: 34px;
        height: 34px;
        border-radius: 50%;
        overflow: hidden;
        border: 2px solid rgba(255,255,255,0.6);
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        background: #222;
    }

    .profile-icon-img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .room-title {
        font-size: 30px;
        margin-top: 40px;
        font-weight: 700;
    }

    .room-desc {
        margin-top: 10px;
        color: #cfcfcf;
        line-height: 1.6;
        max-width: 600px;
    }

    .join-btn {
        margin-top: 25px;
        padding: 14px 35px;
        font-size: 18px;
        border: none;
        border-radius: 30px;
        background: #4dc9ff;
        cursor: pointer;
        color: black;
        transition: 0.3s;
    }

    .join-btn:hover {
        background: #61d4ff;
        transform: translateY(-2px);
    }

</style>
</head>

<body>

<div class="bg1"></div>
<div class="bg2"></div>

<!-- SIDEBAR -->
<div class="sidebar">
    <h3>Rooms</h3>

    <div class="room-item" onclick="openProfile()">üë§ My Profile</div>
    <div class="room-item active" onclick="selectRoom('general')">General Chat</div>
    <div class="room-item" onclick="selectRoom('tech')">Tech Talk</div>
    <div class="room-item" onclick="selectRoom('fun')">Fun Zone</div>
    <div class="room-item" onclick="selectRoom('love')">Love Room</div>
    <div class="room-item" onclick="selectRoom('gaming')">Gaming Hub</div>
    <div class="room-item" style="background:#ff4d4d;" onclick="logoutUser()">Logout</div>
</div>

<!-- MAIN PANEL -->
<div class="main-panel">

    <div class="top-buttons">

        <!-- Minimize & Close buttons -->
        <div class="top-btn" onclick="minimize()">‚Äî</div>
        <div class="top-btn" onclick="closePanel()">√ó</div>

        <!-- ‚≠ê PROFILE DP ICON -->
        <div class="profile-btn" onclick="openProfile()">
            <img id="profileIcon" class="profile-icon-img">
        </div>

    </div>

    <div id="roomContent">
        <div class="room-title">General Chat</div>
        <div class="room-desc">
            The main public chat room where all users can talk freely.  
            A place to meet new people and start conversations.
        </div>

        <button class="join-btn" onclick="joinRoom('general')">Join Room</button>
    </div>

</div>

<script>

    // ROOM DETAILS DATA
    const roomData = {
        general: { title: "General Chat", desc: "The main public chat room where everyone can talk freely. Perfect for casual chatting." },
        tech: { title: "Tech Talk", desc: "Discuss coding, gadgets, AI, software, and all tech-related topics." },
        fun: { title: "Fun Zone", desc: "Jokes, memes, fun talks and unlimited entertainment happen here." },
        love: { title: "Love Room", desc: "Friendly & soft conversations. A room for emotional bonding." },
        gaming: { title: "Gaming Hub", desc: "Talk about PUBG, FreeFire, BGMI, COD, and all your favorite games." }
    };

    // LOAD USER
    let user = localStorage.getItem("chat_username");

    try {
        const parsed = JSON.parse(user);
        if (parsed.username) user = parsed.username;
    } catch {}

    if (!user) window.location.href = "/";

    // SELECT ROOM FUNCTION
    function selectRoom(roomId) {

        document.querySelectorAll(".room-item").forEach(r => r.classList.remove("active"));
        event.target.classList.add("active");

        const data = roomData[roomId];

        document.getElementById("roomContent").innerHTML =
            `<div class="room-title">${data.title}</div>
             <div class="room-desc">${data.desc}</div>
             <button class="join-btn" onclick="joinRoom('${roomId}')">Join Room</button>`;
    }

    // JOIN ROOM
    function joinRoom(roomId) {
        window.location.href = "/chat.html?room=" + roomId;
    }

    // BUTTONS
    function minimize() { alert("Minimize button clicked (UI only)."); }
    function closePanel() { window.location.href = "/"; }

    // LOGOUT
    function logoutUser() {
        localStorage.removeItem("chat_username");
        window.location.href = "/";
    }

    // ‚≠ê NEW ‚Äî OPEN PROFILE PAGE
    function openProfile() {
        window.location.href = "/userprofile.html";
    }

    // ‚≠ê NEW ‚Äî LOAD PROFILE DP ICON
    let dp = localStorage.getItem("dp_image");
    let icon = document.getElementById("profileIcon");

    if (dp) {
        icon.src = dp;
    } else {
        // default user icon (white SVG)
        icon.src = "data:image/svg+xml;base64,PHN2ZyBmaWxsPSJ3aGl0ZSIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEyIDEyYzIuNzY1IDAgNS0yLjIzNSA1LTVzLTIuMjM1LTUtNS01LTUgMi4yMzUtNSA1IDIuMjM1IDUgNSA1em0wIDJjLTMuMzEgMC05IDIuNjU1LTkgNS45VjIxbDE4LjAwMS0uMDExdi0xLjA5QzIxIDE2LjY1NSAxNS4zMSAxNCAxMiAxNHoiLz48L3N2Zz4=";
    }

</script>

</body>
</html>
